{"main.py": [{"type": "function", "rank": "A", "lineno": 38, "complexity": 1, "name": "root", "col_offset": 0, "endline": 39, "closures": []}], "core\\config.py": [{"type": "class", "rank": "A", "lineno": 5, "complexity": 1, "name": "Settings", "col_offset": 0, "endline": 27, "methods": []}], "core\\database.py": [{"type": "function", "rank": "A", "lineno": 10, "complexity": 1, "name": "get_db", "col_offset": 0, "endline": 15, "closures": []}], "core\\email.py": [{"type": "function", "rank": "A", "lineno": 20, "complexity": 3, "name": "send_email", "col_offset": 0, "endline": 42, "closures": []}, {"type": "function", "rank": "A", "lineno": 44, "complexity": 1, "name": "send_verification_email", "col_offset": 0, "endline": 83, "closures": []}, {"type": "function", "rank": "A", "lineno": 86, "complexity": 1, "name": "send_password_reset_email", "col_offset": 0, "endline": 125, "closures": []}, {"type": "function", "rank": "A", "lineno": 128, "complexity": 1, "name": "send_incident_notification", "col_offset": 0, "endline": 161, "closures": []}], "core\\security.py": [{"type": "function", "rank": "A", "lineno": 38, "complexity": 3, "name": "get_response", "col_offset": 0, "endline": 51, "closures": []}, {"type": "function", "rank": "A", "lineno": 20, "complexity": 2, "name": "create_access_token", "col_offset": 0, "endline": 27, "closures": []}, {"type": "function", "rank": "A", "lineno": 29, "complexity": 2, "name": "verify_token", "col_offset": 0, "endline": 34, "closures": []}, {"type": "function", "rank": "A", "lineno": 14, "complexity": 1, "name": "verify_password", "col_offset": 0, "endline": 15, "closures": []}, {"type": "function", "rank": "A", "lineno": 17, "complexity": 1, "name": "get_password_hash", "col_offset": 0, "endline": 18, "closures": []}, {"type": "function", "rank": "A", "lineno": 36, "complexity": 1, "name": "generate_verification_code", "col_offset": 0, "endline": 37, "closures": []}], "enums\\incident.py": [{"type": "class", "rank": "A", "lineno": 3, "complexity": 1, "name": "IncidentCategory", "col_offset": 0, "endline": 9, "methods": []}, {"type": "class", "rank": "A", "lineno": 11, "complexity": 1, "name": "IncidentStatus", "col_offset": 0, "endline": 15, "methods": []}], "enums\\reaction.py": [{"type": "class", "rank": "A", "lineno": 3, "complexity": 1, "name": "ReactionType", "col_offset": 0, "endline": 7, "methods": []}], "models\\incident.py": [{"type": "class", "rank": "A", "lineno": 8, "complexity": 1, "name": "Incident", "col_offset": 0, "endline": 25, "methods": []}, {"type": "class", "rank": "A", "lineno": 27, "complexity": 1, "name": "Comment", "col_offset": 0, "endline": 39, "methods": []}], "models\\reaction.py": [{"type": "class", "rank": "A", "lineno": 7, "complexity": 1, "name": "Reaction", "col_offset": 0, "endline": 18, "methods": []}], "models\\user.py": [{"type": "class", "rank": "A", "lineno": 6, "complexity": 1, "name": "User", "col_offset": 0, "endline": 23, "methods": []}], "routes\\admin.py": [{"type": "function", "rank": "C", "lineno": 714, "complexity": 14, "name": "bulk_moderate_incidents", "col_offset": 0, "endline": 780, "closures": []}, {"type": "function", "rank": "C", "lineno": 271, "complexity": 12, "name": "get_users_management", "col_offset": 0, "endline": 360, "closures": []}, {"type": "function", "rank": "C", "lineno": 562, "complexity": 11, "name": "get_incidents_for_moderation", "col_offset": 0, "endline": 628, "closures": []}, {"type": "function", "rank": "C", "lineno": 631, "complexity": 11, "name": "moderate_incident", "col_offset": 0, "endline": 711, "closures": []}, {"type": "function", "rank": "C", "lineno": 976, "complexity": 11, "name": "generate_incidents_report", "col_offset": 0, "endline": 1049, "closures": []}, {"type": "function", "rank": "B", "lineno": 205, "complexity": 8, "name": "get_performance_analytics", "col_offset": 0, "endline": 264, "closures": []}, {"type": "function", "rank": "B", "lineno": 509, "complexity": 7, "name": "delete_user", "col_offset": 0, "endline": 557, "closures": []}, {"type": "function", "rank": "B", "lineno": 89, "complexity": 6, "name": "get_category_analytics", "col_offset": 0, "endline": 132, "closures": []}, {"type": "function", "rank": "B", "lineno": 432, "complexity": 6, "name": "update_user_status", "col_offset": 0, "endline": 470, "closures": []}, {"type": "function", "rank": "A", "lineno": 363, "complexity": 5, "name": "get_user_details", "col_offset": 0, "endline": 427, "closures": []}, {"type": "function", "rank": "A", "lineno": 827, "complexity": 5, "name": "moderate_comment", "col_offset": 0, "endline": 884, "closures": []}, {"type": "function", "rank": "A", "lineno": 889, "complexity": 5, "name": "get_system_info", "col_offset": 0, "endline": 933, "closures": []}, {"type": "function", "rank": "A", "lineno": 1053, "complexity": 5, "name": "generate_users_report", "col_offset": 0, "endline": 1105, "closures": []}, {"type": "function", "rank": "A", "lineno": 135, "complexity": 4, "name": "get_trends_analytics", "col_offset": 0, "endline": 200, "closures": []}, {"type": "function", "rank": "A", "lineno": 473, "complexity": 4, "name": "update_user_admin_status", "col_offset": 0, "endline": 506, "closures": []}, {"type": "function", "rank": "A", "lineno": 786, "complexity": 4, "name": "get_comments_for_moderation", "col_offset": 0, "endline": 823, "closures": []}, {"type": "function", "rank": "A", "lineno": 937, "complexity": 3, "name": "get_system_logs", "col_offset": 0, "endline": 971, "closures": []}, {"type": "function", "rank": "A", "lineno": 1110, "complexity": 2, "name": "log_admin_action", "col_offset": 0, "endline": 1134, "closures": []}, {"type": "function", "rank": "A", "lineno": 1137, "complexity": 2, "name": "create_admin_logs_table", "col_offset": 0, "endline": 1155, "closures": []}, {"type": "function", "rank": "A", "lineno": 1160, "complexity": 2, "name": "initialize_admin_system", "col_offset": 0, "endline": 1175, "closures": []}, {"type": "function", "rank": "A", "lineno": 26, "complexity": 1, "name": "get_admin_dashboard", "col_offset": 0, "endline": 85, "closures": []}], "routes\\auth.py": [{"type": "function", "rank": "B", "lineno": 46, "complexity": 8, "name": "verify_email", "col_offset": 0, "endline": 79, "closures": []}, {"type": "function", "rank": "B", "lineno": 83, "complexity": 6, "name": "login", "col_offset": 0, "endline": 136, "closures": []}, {"type": "function", "rank": "A", "lineno": 160, "complexity": 5, "name": "get_current_admin", "col_offset": 0, "endline": 185, "closures": []}, {"type": "function", "rank": "A", "lineno": 139, "complexity": 4, "name": "get_current_user", "col_offset": 0, "endline": 158, "closures": []}, {"type": "function", "rank": "A", "lineno": 20, "complexity": 2, "name": "register", "col_offset": 0, "endline": 41, "closures": []}], "routes\\files.py": [{"type": "function", "rank": "A", "lineno": 11, "complexity": 2, "name": "upload_file", "col_offset": 0, "endline": 26, "closures": []}, {"type": "function", "rank": "A", "lineno": 30, "complexity": 2, "name": "download_file", "col_offset": 0, "endline": 43, "closures": []}], "routes\\incidents.py": [{"type": "function", "rank": "C", "lineno": 69, "complexity": 18, "name": "get_incidents", "col_offset": 0, "endline": 172, "closures": []}, {"type": "function", "rank": "B", "lineno": 176, "complexity": 6, "name": "search_incidents", "col_offset": 0, "endline": 215, "closures": []}, {"type": "function", "rank": "B", "lineno": 218, "complexity": 6, "name": "get_incident", "col_offset": 0, "endline": 257, "closures": []}, {"type": "function", "rank": "B", "lineno": 284, "complexity": 6, "name": "update_incident", "col_offset": 0, "endline": 308, "closures": []}, {"type": "function", "rank": "A", "lineno": 371, "complexity": 4, "name": "delete_incident", "col_offset": 0, "endline": 387, "closures": []}, {"type": "function", "rank": "A", "lineno": 24, "complexity": 3, "name": "create_incident", "col_offset": 0, "endline": 66, "closures": []}, {"type": "function", "rank": "A", "lineno": 333, "complexity": 3, "name": "toggle_reaction", "col_offset": 0, "endline": 368, "closures": []}, {"type": "function", "rank": "A", "lineno": 261, "complexity": 2, "name": "create_comment", "col_offset": 0, "endline": 280, "closures": []}, {"type": "function", "rank": "A", "lineno": 311, "complexity": 2, "name": "get_comments", "col_offset": 0, "endline": 330, "closures": []}], "routes\\users.py": [{"type": "function", "rank": "A", "lineno": 49, "complexity": 3, "name": "upload_profile_image", "col_offset": 0, "endline": 66, "closures": []}, {"type": "function", "rank": "A", "lineno": 35, "complexity": 2, "name": "update_user_profile", "col_offset": 0, "endline": 46, "closures": []}, {"type": "function", "rank": "A", "lineno": 70, "complexity": 2, "name": "get_user_by_id", "col_offset": 0, "endline": 89, "closures": []}, {"type": "function", "rank": "A", "lineno": 109, "complexity": 2, "name": "get_user_incidents", "col_offset": 0, "endline": 129, "closures": []}, {"type": "function", "rank": "A", "lineno": 18, "complexity": 1, "name": "get_user_profile", "col_offset": 0, "endline": 32, "closures": []}, {"type": "function", "rank": "A", "lineno": 92, "complexity": 1, "name": "get_user_stats", "col_offset": 0, "endline": 105, "closures": []}], "schemas\\incident.py": [{"type": "class", "rank": "A", "lineno": 18, "complexity": 4, "name": "IncidentResponse", "col_offset": 0, "endline": 39, "methods": [{"type": "method", "rank": "A", "classname": "IncidentResponse", "lineno": 34, "complexity": 3, "name": "convert_datetime_to_string", "col_offset": 4, "endline": 39, "closures": []}]}, {"type": "method", "rank": "A", "classname": "IncidentResponse", "lineno": 34, "complexity": 3, "name": "convert_datetime_to_string", "col_offset": 4, "endline": 39, "closures": []}, {"type": "class", "rank": "A", "lineno": 7, "complexity": 1, "name": "IncidentCreate", "col_offset": 0, "endline": 11, "methods": []}, {"type": "class", "rank": "A", "lineno": 13, "complexity": 1, "name": "AuthorResponse", "col_offset": 0, "endline": 16, "methods": []}, {"type": "class", "rank": "A", "lineno": 44, "complexity": 1, "name": "CommentCreate", "col_offset": 0, "endline": 45, "methods": []}, {"type": "class", "rank": "A", "lineno": 47, "complexity": 1, "name": "CommentResponse", "col_offset": 0, "endline": 51, "methods": []}, {"type": "class", "rank": "A", "lineno": 53, "complexity": 1, "name": "IncidentUpdate", "col_offset": 0, "endline": 57, "methods": []}], "schemas\\user.py": [{"type": "class", "rank": "A", "lineno": 4, "complexity": 1, "name": "UserCreate", "col_offset": 0, "endline": 7, "methods": []}, {"type": "class", "rank": "A", "lineno": 9, "complexity": 1, "name": "UserResponse", "col_offset": 0, "endline": 15, "methods": []}, {"type": "class", "rank": "A", "lineno": 17, "complexity": 1, "name": "Token", "col_offset": 0, "endline": 20, "methods": []}, {"type": "class", "rank": "A", "lineno": 22, "complexity": 1, "name": "IResponse", "col_offset": 0, "endline": 24, "methods": []}, {"type": "class", "rank": "A", "lineno": 27, "complexity": 1, "name": "UserProfile", "col_offset": 0, "endline": 33, "methods": []}, {"type": "class", "rank": "A", "lineno": 35, "complexity": 1, "name": "UserUpdate", "col_offset": 0, "endline": 36, "methods": []}, {"type": "class", "rank": "A", "lineno": 38, "complexity": 1, "name": "UserStats", "col_offset": 0, "endline": 41, "methods": []}, {"type": "class", "rank": "A", "lineno": 43, "complexity": 1, "name": "AdminDashboardStats", "col_offset": 0, "endline": 58, "methods": []}, {"type": "class", "rank": "A", "lineno": 60, "complexity": 1, "name": "CategoryAnalytics", "col_offset": 0, "endline": 66, "methods": []}, {"type": "class", "rank": "A", "lineno": 68, "complexity": 1, "name": "UserAnalytics", "col_offset": 0, "endline": 77, "methods": []}, {"type": "class", "rank": "A", "lineno": 79, "complexity": 1, "name": "IncidentAnalytics", "col_offset": 0, "endline": 89, "methods": []}, {"type": "class", "rank": "A", "lineno": 91, "complexity": 1, "name": "SystemSettings", "col_offset": 0, "endline": 98, "methods": []}, {"type": "class", "rank": "A", "lineno": 100, "complexity": 1, "name": "ModerationAction", "col_offset": 0, "endline": 103, "methods": []}, {"type": "class", "rank": "A", "lineno": 105, "complexity": 1, "name": "BulkAction", "col_offset": 0, "endline": 108, "methods": []}, {"type": "class", "rank": "A", "lineno": 110, "complexity": 1, "name": "SystemLog", "col_offset": 0, "endline": 116, "methods": []}], "utils\\file_upload.py": [{"type": "function", "rank": "C", "lineno": 51, "complexity": 16, "name": "validate_file", "col_offset": 0, "endline": 120, "closures": []}, {"type": "function", "rank": "C", "lineno": 242, "complexity": 12, "name": "_process_image", "col_offset": 0, "endline": 295, "closures": []}, {"type": "function", "rank": "B", "lineno": 549, "complexity": 8, "name": "convert_image_format", "col_offset": 0, "endline": 600, "closures": []}, {"type": "function", "rank": "B", "lineno": 122, "complexity": 7, "name": "_is_safe_filename", "col_offset": 0, "endline": 139, "closures": []}, {"type": "function", "rank": "B", "lineno": 171, "complexity": 7, "name": "save_uploaded_file", "col_offset": 0, "endline": 240, "closures": []}, {"type": "function", "rank": "B", "lineno": 357, "complexity": 6, "name": "cleanup_old_files", "col_offset": 0, "endline": 391, "closures": []}, {"type": "function", "rank": "A", "lineno": 405, "complexity": 5, "name": "validate_and_save_multiple_files", "col_offset": 0, "endline": 447, "closures": []}, {"type": "function", "rank": "A", "lineno": 298, "complexity": 4, "name": "delete_file", "col_offset": 0, "endline": 322, "closures": []}, {"type": "function", "rank": "A", "lineno": 324, "complexity": 4, "name": "get_file_info", "col_offset": 0, "endline": 355, "closures": []}, {"type": "function", "rank": "A", "lineno": 511, "complexity": 4, "name": "compress_image", "col_offset": 0, "endline": 547, "closures": []}, {"type": "function", "rank": "A", "lineno": 450, "complexity": 3, "name": "create_thumbnail", "col_offset": 0, "endline": 487, "closures": []}, {"type": "function", "rank": "A", "lineno": 489, "complexity": 3, "name": "get_image_dimensions", "col_offset": 0, "endline": 509, "closures": []}, {"type": "function", "rank": "A", "lineno": 42, "complexity": 2, "name": "create_upload_directories", "col_offset": 0, "endline": 46, "closures": []}, {"type": "function", "rank": "A", "lineno": 141, "complexity": 2, "name": "generate_unique_filename", "col_offset": 0, "endline": 169, "closures": []}, {"type": "function", "rank": "A", "lineno": 393, "complexity": 1, "name": "get_file_hash", "col_offset": 0, "endline": 403, "closures": []}], "utils\\validators.py": [{"type": "function", "rank": "B", "lineno": 10, "complexity": 6, "name": "validate_password", "col_offset": 0, "endline": 32, "closures": []}, {"type": "function", "rank": "A", "lineno": 54, "complexity": 5, "name": "validate_incident_title", "col_offset": 0, "endline": 64, "closures": []}, {"type": "function", "rank": "A", "lineno": 40, "complexity": 4, "name": "sanitize_input", "col_offset": 0, "endline": 52, "closures": []}, {"type": "function", "rank": "A", "lineno": 66, "complexity": 3, "name": "validate_location", "col_offset": 0, "endline": 76, "closures": []}, {"type": "function", "rank": "A", "lineno": 5, "complexity": 1, "name": "validate_email", "col_offset": 0, "endline": 8, "closures": []}, {"type": "function", "rank": "A", "lineno": 34, "complexity": 1, "name": "validate_phone_number", "col_offset": 0, "endline": 38, "closures": []}]}
